Base: facebook/contriever-msmarco
Time-Aware: ./contriever_finetuned_NEW_20k
Loading Models...
2025-12-11 05:22:14.661603: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-12-11 05:22:14.680172: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1765430534.702363  118884 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1765430534.709009  118884 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1765430534.726239  118884 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1765430534.726274  118884 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1765430534.726276  118884 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1765430534.726278  118884 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-12-11 05:22:14.731404: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Loading SQuAD dataset (validation split)...
Filtering for strictly TEMPORAL questions (Years or 'When')...
Scanning:   0%|          | 0/10570 [00:00<?, ?it/s]Scanning:  13%|█▎        | 1328/10570 [00:00<00:00, 13273.97it/s]Scanning:  25%|██▌       | 2692/10570 [00:00<00:00, 13484.12it/s]Scanning:  38%|███▊      | 4041/10570 [00:00<00:00, 13419.85it/s]Scanning:  51%|█████     | 5397/10570 [00:00<00:00, 13472.60it/s]Scanning:  64%|██████▍   | 6745/10570 [00:00<00:00, 13394.52it/s]Scanning:  68%|██████▊   | 7195/10570 [00:00<00:00, 13408.36it/s]

[Stats] Scanned: 7196 | Kept (Temporal): 1000
[Stats] Unique Passages: 564

========================================
SAMPLE FILTERED QUESTIONS
========================================
Q1: What year did the Denver Broncos secure a Super Bowl title for the third time?
Q2: What year was Super Bowl 50?
Q3: What 2015 NFL team one the AFC playoff?
Q4: What year was the Carolina Panthers franchise founded?
Q5: What was the win/loss ratio in 2015 for the Carolina Panthers during their regular season?
========================================


========================================
PHASE 1: BASE MODEL EVALUATION
========================================
Building FAISS index (IP) with 564 passages...
Encoding:   0%|          | 0/5 [00:00<?, ?it/s]Encoding:  20%|██        | 1/5 [00:00<00:02,  1.79it/s]Encoding:  40%|████      | 2/5 [00:00<00:01,  2.61it/s]Encoding:  60%|██████    | 3/5 [00:01<00:00,  3.06it/s]Encoding:  80%|████████  | 4/5 [00:01<00:00,  3.33it/s]Encoding: 100%|██████████| 5/5 [00:01<00:00,  4.35it/s]                                                       Pre-computing Base Windows...
Pre-computing window embeddings for 564 passages...
Total windows to encode: 1816
Encoding Windows:   0%|          | 0/15 [00:00<?, ?it/s]Encoding Windows:   7%|▋         | 1/15 [00:00<00:01,  8.02it/s]Encoding Windows:  13%|█▎        | 2/15 [00:00<00:01,  7.96it/s]Encoding Windows:  20%|██        | 3/15 [00:00<00:01,  7.92it/s]Encoding Windows:  27%|██▋       | 4/15 [00:00<00:01,  7.89it/s]Encoding Windows:  33%|███▎      | 5/15 [00:00<00:01,  7.88it/s]Encoding Windows:  40%|████      | 6/15 [00:00<00:01,  7.88it/s]Encoding Windows:  47%|████▋     | 7/15 [00:00<00:01,  7.90it/s]Encoding Windows:  53%|█████▎    | 8/15 [00:01<00:00,  7.86it/s]Encoding Windows:  60%|██████    | 9/15 [00:01<00:00,  7.85it/s]Encoding Windows:  67%|██████▋   | 10/15 [00:01<00:00,  7.86it/s]Encoding Windows:  73%|███████▎  | 11/15 [00:01<00:00,  7.83it/s]Encoding Windows:  80%|████████  | 12/15 [00:01<00:00,  7.80it/s]Encoding Windows:  87%|████████▋ | 13/15 [00:01<00:00,  7.77it/s]Encoding Windows:  93%|█████████▎| 14/15 [00:01<00:00,  7.80it/s]Encoding Windows: 100%|██████████| 15/15 [00:01<00:00,  8.29it/s]

[EVAL] Base Only | q=1000 | mrag=False
Encoding:   0%|          | 0/8 [00:00<?, ?it/s]Encoding:  50%|█████     | 4/8 [00:00<00:00, 38.77it/s]Encoding: 100%|██████████| 8/8 [00:00<00:00, 37.70it/s]                                                       Reranking:   0%|          | 0/1000 [00:00<?, ?it/s]Reranking: 100%|██████████| 1000/1000 [00:00<00:00, 35757.07it/s]
Results for Base Only: {'hit@1': 0.717, 'hit@5': 0.921, 'hit@10': 0.954, 'hit@20': 0.972, 'mrr@1': 0.717, 'mrr@5': 0.7992500000000003, 'mrr@10': 0.8038055555555559, 'mrr@20': 0.8050791087996974}

[EVAL] MRAG + Base | q=1000 | mrag=True
Encoding:   0%|          | 0/8 [00:00<?, ?it/s]Encoding:  62%|██████▎   | 5/8 [00:00<00:00, 39.99it/s]                                                       Reranking:   0%|          | 0/1000 [00:00<?, ?it/s]Reranking:   0%|          | 1/1000 [00:00<01:56,  8.59it/s]Reranking:   1%|          | 8/1000 [00:00<00:24, 40.56it/s]Reranking:   2%|▏         | 15/1000 [00:00<00:18, 52.44it/s]Reranking:   2%|▏         | 22/1000 [00:00<00:16, 58.64it/s]Reranking:   3%|▎         | 29/1000 [00:00<00:15, 62.30it/s]Reranking:   4%|▎         | 36/1000 [00:00<00:14, 64.85it/s]Reranking:   4%|▍         | 43/1000 [00:00<00:14, 66.37it/s]Reranking:   5%|▌         | 50/1000 [00:00<00:14, 66.79it/s]Reranking:   6%|▌         | 57/1000 [00:00<00:13, 67.74it/s]Reranking:   6%|▋         | 64/1000 [00:01<00:13, 68.12it/s]Reranking:   7%|▋         | 71/1000 [00:01<00:13, 67.33it/s]Reranking:   8%|▊         | 78/1000 [00:01<00:13, 67.88it/s]Reranking:   8%|▊         | 85/1000 [00:01<00:13, 67.54it/s]Reranking:   9%|▉         | 92/1000 [00:01<00:13, 67.90it/s]Reranking:  10%|▉         | 99/1000 [00:01<00:13, 68.09it/s]Reranking:  11%|█         | 106/1000 [00:01<00:13, 68.42it/s]Reranking:  11%|█▏        | 113/1000 [00:01<00:12, 68.40it/s]Reranking:  12%|█▏        | 121/1000 [00:01<00:12, 68.99it/s]Reranking:  13%|█▎        | 128/1000 [00:01<00:12, 68.98it/s]Reranking:  14%|█▎        | 135/1000 [00:02<00:12, 68.72it/s]Reranking:  14%|█▍        | 142/1000 [00:02<00:12, 68.95it/s]Reranking:  15%|█▍        | 149/1000 [00:02<00:12, 69.20it/s]Reranking:  16%|█▌        | 156/1000 [00:02<00:12, 69.30it/s]Reranking:  16%|█▋        | 163/1000 [00:02<00:12, 69.37it/s]Reranking:  17%|█▋        | 170/1000 [00:02<00:11, 69.21it/s]Reranking:  18%|█▊        | 177/1000 [00:02<00:11, 69.25it/s]Reranking:  18%|█▊        | 184/1000 [00:02<00:11, 69.08it/s]Reranking:  19%|█▉        | 191/1000 [00:02<00:11, 69.19it/s]Reranking:  20%|█▉        | 199/1000 [00:02<00:11, 69.52it/s]Reranking:  21%|██        | 206/1000 [00:03<00:11, 69.21it/s]Reranking:  21%|██▏       | 213/1000 [00:03<00:11, 68.36it/s]Reranking:  22%|██▏       | 220/1000 [00:03<00:11, 68.65it/s]Reranking:  23%|██▎       | 227/1000 [00:03<00:11, 68.39it/s]Reranking:  23%|██▎       | 234/1000 [00:03<00:11, 68.56it/s]Reranking:  24%|██▍       | 241/1000 [00:03<00:11, 68.43it/s]Reranking:  25%|██▍       | 248/1000 [00:03<00:10, 68.67it/s]Reranking:  26%|██▌       | 255/1000 [00:03<00:10, 68.88it/s]Reranking:  26%|██▌       | 262/1000 [00:03<00:10, 67.73it/s]Reranking:  27%|██▋       | 269/1000 [00:04<00:10, 66.86it/s]Reranking:  28%|██▊       | 276/1000 [00:04<00:10, 66.84it/s]Reranking:  28%|██▊       | 283/1000 [00:04<00:10, 67.10it/s]Reranking:  29%|██▉       | 290/1000 [00:04<00:10, 67.72it/s]Reranking:  30%|██▉       | 297/1000 [00:04<00:10, 67.58it/s]Reranking:  30%|███       | 304/1000 [00:04<00:10, 68.23it/s]Reranking:  31%|███       | 311/1000 [00:04<00:10, 68.60it/s]Reranking:  32%|███▏      | 318/1000 [00:04<00:09, 68.85it/s]Reranking:  33%|███▎      | 326/1000 [00:04<00:09, 69.25it/s]Reranking:  33%|███▎      | 334/1000 [00:04<00:09, 70.01it/s]Reranking:  34%|███▍      | 341/1000 [00:05<00:09, 69.73it/s]Reranking:  35%|███▍      | 348/1000 [00:05<00:09, 69.59it/s]Reranking:  36%|███▌      | 356/1000 [00:05<00:09, 70.02it/s]Reranking:  36%|███▋      | 363/1000 [00:05<00:09, 69.22it/s]Reranking:  37%|███▋      | 370/1000 [00:05<00:09, 69.06it/s]Reranking:  38%|███▊      | 377/1000 [00:05<00:08, 69.25it/s]Reranking:  38%|███▊      | 384/1000 [00:05<00:08, 68.98it/s]Reranking:  39%|███▉      | 392/1000 [00:05<00:08, 69.67it/s]Reranking:  40%|███▉      | 399/1000 [00:05<00:08, 69.37it/s]Reranking:  41%|████      | 407/1000 [00:06<00:08, 69.55it/s]Reranking:  41%|████▏     | 414/1000 [00:06<00:08, 67.21it/s]Reranking:  42%|████▏     | 421/1000 [00:06<00:08, 66.78it/s]Reranking:  43%|████▎     | 428/1000 [00:06<00:08, 66.69it/s]Reranking:  44%|████▎     | 435/1000 [00:06<00:08, 66.68it/s]Reranking:  44%|████▍     | 442/1000 [00:06<00:08, 66.64it/s]Reranking:  45%|████▍     | 449/1000 [00:06<00:08, 66.59it/s]Reranking:  46%|████▌     | 456/1000 [00:06<00:08, 66.91it/s]Reranking:  46%|████▋     | 463/1000 [00:06<00:07, 67.23it/s]Reranking:  47%|████▋     | 470/1000 [00:06<00:07, 66.83it/s]Reranking:  48%|████▊     | 477/1000 [00:07<00:07, 66.60it/s]Reranking:  48%|████▊     | 484/1000 [00:07<00:07, 67.04it/s]Reranking:  49%|████▉     | 491/1000 [00:07<00:07, 66.69it/s]Reranking:  50%|████▉     | 498/1000 [00:07<00:07, 67.21it/s]Reranking:  50%|█████     | 505/1000 [00:07<00:07, 67.41it/s]Reranking:  51%|█████     | 512/1000 [00:07<00:07, 66.78it/s]Reranking:  52%|█████▏    | 519/1000 [00:07<00:07, 67.47it/s]Reranking:  53%|█████▎    | 526/1000 [00:07<00:06, 67.85it/s]Reranking:  53%|█████▎    | 533/1000 [00:07<00:06, 67.81it/s]Reranking:  54%|█████▍    | 540/1000 [00:08<00:06, 67.35it/s]Reranking:  55%|█████▍    | 547/1000 [00:08<00:06, 67.60it/s]Reranking:  55%|█████▌    | 554/1000 [00:08<00:06, 67.57it/s]Reranking:  56%|█████▌    | 561/1000 [00:08<00:06, 67.33it/s]Reranking:  57%|█████▋    | 568/1000 [00:08<00:06, 67.19it/s]Reranking:  57%|█████▊    | 575/1000 [00:08<00:06, 67.18it/s]Reranking:  58%|█████▊    | 582/1000 [00:08<00:06, 66.91it/s]Reranking:  59%|█████▉    | 589/1000 [00:08<00:06, 67.43it/s]Reranking:  60%|█████▉    | 596/1000 [00:08<00:05, 67.87it/s]Reranking:  60%|██████    | 604/1000 [00:08<00:05, 68.60it/s]Reranking:  61%|██████    | 611/1000 [00:09<00:05, 68.69it/s]Reranking:  62%|██████▏   | 618/1000 [00:09<00:05, 68.32it/s]Reranking:  62%|██████▎   | 625/1000 [00:09<00:05, 68.55it/s]Reranking:  63%|██████▎   | 633/1000 [00:09<00:05, 69.12it/s]Reranking:  64%|██████▍   | 641/1000 [00:09<00:05, 69.51it/s]Reranking:  65%|██████▍   | 648/1000 [00:09<00:05, 69.01it/s]Reranking:  66%|██████▌   | 655/1000 [00:09<00:05, 68.90it/s]Reranking:  66%|██████▌   | 662/1000 [00:09<00:04, 69.07it/s]Reranking:  67%|██████▋   | 669/1000 [00:09<00:04, 69.04it/s]Reranking:  68%|██████▊   | 676/1000 [00:10<00:04, 68.96it/s]Reranking:  68%|██████▊   | 683/1000 [00:10<00:04, 68.28it/s]Reranking:  69%|██████▉   | 690/1000 [00:10<00:04, 68.17it/s]Reranking:  70%|██████▉   | 697/1000 [00:10<00:04, 68.28it/s]Reranking:  70%|███████   | 704/1000 [00:10<00:04, 68.68it/s]Reranking:  71%|███████   | 711/1000 [00:10<00:04, 68.73it/s]Reranking:  72%|███████▏  | 718/1000 [00:10<00:04, 68.47it/s]Reranking:  73%|███████▎  | 726/1000 [00:10<00:03, 69.00it/s]Reranking:  73%|███████▎  | 733/1000 [00:10<00:03, 69.14it/s]Reranking:  74%|███████▍  | 740/1000 [00:10<00:03, 68.20it/s]Reranking:  75%|███████▍  | 747/1000 [00:11<00:03, 68.41it/s]Reranking:  75%|███████▌  | 754/1000 [00:11<00:03, 68.49it/s]Reranking:  76%|███████▌  | 761/1000 [00:11<00:03, 68.82it/s]Reranking:  77%|███████▋  | 769/1000 [00:11<00:03, 69.14it/s]Reranking:  78%|███████▊  | 776/1000 [00:11<00:03, 69.23it/s]Reranking:  78%|███████▊  | 783/1000 [00:11<00:03, 69.33it/s]Reranking:  79%|███████▉  | 790/1000 [00:11<00:03, 69.09it/s]Reranking:  80%|███████▉  | 797/1000 [00:11<00:02, 68.71it/s]Reranking:  80%|████████  | 804/1000 [00:11<00:02, 68.71it/s]Reranking:  81%|████████  | 812/1000 [00:11<00:02, 69.16it/s]Reranking:  82%|████████▏ | 819/1000 [00:12<00:02, 67.98it/s]Reranking:  83%|████████▎ | 826/1000 [00:12<00:02, 68.20it/s]Reranking:  83%|████████▎ | 833/1000 [00:12<00:02, 68.52it/s]Reranking:  84%|████████▍ | 840/1000 [00:12<00:02, 68.54it/s]Reranking:  85%|████████▍ | 848/1000 [00:12<00:02, 69.08it/s]Reranking:  86%|████████▌ | 856/1000 [00:12<00:02, 69.28it/s]Reranking:  86%|████████▋ | 863/1000 [00:12<00:01, 68.80it/s]Reranking:  87%|████████▋ | 871/1000 [00:12<00:01, 69.33it/s]Reranking:  88%|████████▊ | 878/1000 [00:12<00:01, 68.45it/s]Reranking:  89%|████████▊ | 886/1000 [00:13<00:01, 68.97it/s]Reranking:  89%|████████▉ | 893/1000 [00:13<00:01, 69.14it/s]Reranking:  90%|█████████ | 900/1000 [00:13<00:01, 68.90it/s]Reranking:  91%|█████████ | 907/1000 [00:13<00:01, 68.79it/s]Reranking:  91%|█████████▏| 914/1000 [00:13<00:01, 69.08it/s]Reranking:  92%|█████████▏| 921/1000 [00:13<00:01, 68.94it/s]Reranking:  93%|█████████▎| 928/1000 [00:13<00:01, 68.67it/s]Reranking:  94%|█████████▎| 935/1000 [00:13<00:00, 68.34it/s]Reranking:  94%|█████████▍| 942/1000 [00:13<00:00, 68.46it/s]Reranking:  95%|█████████▍| 949/1000 [00:13<00:00, 68.50it/s]Reranking:  96%|█████████▌| 956/1000 [00:14<00:00, 68.64it/s]Reranking:  96%|█████████▋| 963/1000 [00:14<00:00, 68.15it/s]Reranking:  97%|█████████▋| 970/1000 [00:14<00:00, 68.27it/s]Reranking:  98%|█████████▊| 977/1000 [00:14<00:00, 68.53it/s]Reranking:  98%|█████████▊| 984/1000 [00:14<00:00, 68.46it/s]Reranking:  99%|█████████▉| 991/1000 [00:14<00:00, 68.64it/s]Reranking: 100%|█████████▉| 998/1000 [00:14<00:00, 68.38it/s]Reranking: 100%|██████████| 1000/1000 [00:14<00:00, 67.92it/s]
Results for MRAG + Base: {'hit@1': 0.783, 'hit@5': 0.943, 'hit@10': 0.959, 'hit@20': 0.975, 'mrr@1': 0.783, 'mrr@5': 0.8474833333333338, 'mrr@10': 0.8497658730158734, 'mrr@20': 0.8509611142942028}

========================================
PHASE 2: TIME-AWARE MODEL EVALUATION
========================================
Building FAISS index (IP) with 564 passages...
Encoding:   0%|          | 0/5 [00:00<?, ?it/s]Encoding:  20%|██        | 1/5 [00:00<00:01,  3.90it/s]Encoding:  40%|████      | 2/5 [00:00<00:00,  3.87it/s]Encoding:  60%|██████    | 3/5 [00:00<00:00,  3.85it/s]Encoding:  80%|████████  | 4/5 [00:01<00:00,  3.83it/s]Encoding: 100%|██████████| 5/5 [00:01<00:00,  4.88it/s]                                                       Pre-computing Time-Aware Windows...
Pre-computing window embeddings for 564 passages...
Total windows to encode: 1816
Encoding Windows:   0%|          | 0/15 [00:00<?, ?it/s]Encoding Windows:   7%|▋         | 1/15 [00:00<00:01,  7.98it/s]Encoding Windows:  13%|█▎        | 2/15 [00:00<00:01,  7.91it/s]Encoding Windows:  20%|██        | 3/15 [00:00<00:01,  7.90it/s]Encoding Windows:  27%|██▋       | 4/15 [00:00<00:01,  7.88it/s]Encoding Windows:  33%|███▎      | 5/15 [00:00<00:01,  7.87it/s]Encoding Windows:  40%|████      | 6/15 [00:00<00:01,  7.88it/s]Encoding Windows:  47%|████▋     | 7/15 [00:00<00:01,  7.88it/s]Encoding Windows:  53%|█████▎    | 8/15 [00:01<00:00,  7.82it/s]Encoding Windows:  60%|██████    | 9/15 [00:01<00:00,  7.83it/s]Encoding Windows:  67%|██████▋   | 10/15 [00:01<00:00,  7.84it/s]Encoding Windows:  73%|███████▎  | 11/15 [00:01<00:00,  7.84it/s]Encoding Windows:  80%|████████  | 12/15 [00:01<00:00,  7.82it/s]Encoding Windows:  87%|████████▋ | 13/15 [00:01<00:00,  7.81it/s]Encoding Windows:  93%|█████████▎| 14/15 [00:01<00:00,  7.83it/s]Encoding Windows: 100%|██████████| 15/15 [00:01<00:00,  8.30it/s]

[EVAL] Time-Aware Only | q=1000 | mrag=False
Encoding:   0%|          | 0/8 [00:00<?, ?it/s]Encoding:  50%|█████     | 4/8 [00:00<00:00, 39.60it/s]Encoding: 100%|██████████| 8/8 [00:00<00:00, 38.05it/s]                                                       Reranking:   0%|          | 0/1000 [00:00<?, ?it/s]Reranking: 100%|██████████| 1000/1000 [00:00<00:00, 34326.93it/s]
Results for Time-Aware Only: {'hit@1': 0.729, 'hit@5': 0.927, 'hit@10': 0.958, 'hit@20': 0.983, 'mrr@1': 0.729, 'mrr@5': 0.8070166666666674, 'mrr@10': 0.8111091269841274, 'mrr@20': 0.8128618612381775}

[EVAL] MRAG + Time-Aware | q=1000 | mrag=True
Encoding:   0%|          | 0/8 [00:00<?, ?it/s]Encoding:  62%|██████▎   | 5/8 [00:00<00:00, 40.01it/s]                                                       Reranking:   0%|          | 0/1000 [00:00<?, ?it/s]Reranking:   1%|          | 7/1000 [00:00<00:14, 67.47it/s]Reranking:   1%|▏         | 14/1000 [00:00<00:15, 65.15it/s]Reranking:   2%|▏         | 21/1000 [00:00<00:14, 66.65it/s]Reranking:   3%|▎         | 28/1000 [00:00<00:14, 66.88it/s]Reranking:   4%|▎         | 35/1000 [00:00<00:14, 66.42it/s]Reranking:   4%|▍         | 42/1000 [00:00<00:14, 65.97it/s]Reranking:   5%|▍         | 49/1000 [00:00<00:14, 65.73it/s]Reranking:   6%|▌         | 56/1000 [00:00<00:14, 65.33it/s]Reranking:   6%|▋         | 63/1000 [00:00<00:14, 64.58it/s]Reranking:   7%|▋         | 70/1000 [00:01<00:14, 65.35it/s]Reranking:   8%|▊         | 77/1000 [00:01<00:14, 65.28it/s]Reranking:   8%|▊         | 84/1000 [00:01<00:13, 65.49it/s]Reranking:   9%|▉         | 91/1000 [00:01<00:13, 65.47it/s]Reranking:  10%|▉         | 98/1000 [00:01<00:13, 65.56it/s]Reranking:  10%|█         | 105/1000 [00:01<00:13, 65.47it/s]Reranking:  11%|█         | 112/1000 [00:01<00:13, 65.37it/s]Reranking:  12%|█▏        | 119/1000 [00:01<00:13, 65.16it/s]Reranking:  13%|█▎        | 126/1000 [00:01<00:13, 64.63it/s]Reranking:  13%|█▎        | 133/1000 [00:02<00:13, 64.65it/s]Reranking:  14%|█▍        | 140/1000 [00:02<00:13, 64.76it/s]Reranking:  15%|█▍        | 147/1000 [00:02<00:13, 65.11it/s]Reranking:  15%|█▌        | 154/1000 [00:02<00:12, 65.58it/s]Reranking:  16%|█▌        | 161/1000 [00:02<00:12, 66.06it/s]Reranking:  17%|█▋        | 169/1000 [00:02<00:12, 67.35it/s]Reranking:  18%|█▊        | 176/1000 [00:02<00:12, 68.03it/s]Reranking:  18%|█▊        | 183/1000 [00:02<00:11, 68.36it/s]Reranking:  19%|█▉        | 190/1000 [00:02<00:11, 68.70it/s]Reranking:  20%|█▉        | 197/1000 [00:02<00:11, 68.77it/s]Reranking:  20%|██        | 204/1000 [00:03<00:11, 68.81it/s]Reranking:  21%|██        | 211/1000 [00:03<00:11, 69.15it/s]Reranking:  22%|██▏       | 218/1000 [00:03<00:11, 69.21it/s]Reranking:  23%|██▎       | 226/1000 [00:03<00:11, 69.43it/s]Reranking:  23%|██▎       | 234/1000 [00:03<00:10, 69.74it/s]Reranking:  24%|██▍       | 241/1000 [00:03<00:10, 69.70it/s]Reranking:  25%|██▍       | 248/1000 [00:03<00:10, 69.58it/s]Reranking:  26%|██▌       | 256/1000 [00:03<00:10, 69.89it/s]Reranking:  26%|██▋       | 264/1000 [00:03<00:10, 70.06it/s]Reranking:  27%|██▋       | 272/1000 [00:04<00:10, 69.87it/s]Reranking:  28%|██▊       | 279/1000 [00:04<00:10, 69.39it/s]Reranking:  29%|██▊       | 286/1000 [00:04<00:10, 69.33it/s]Reranking:  29%|██▉       | 293/1000 [00:04<00:10, 69.19it/s]Reranking:  30%|███       | 300/1000 [00:04<00:10, 68.91it/s]Reranking:  31%|███       | 307/1000 [00:04<00:10, 68.77it/s]Reranking:  32%|███▏      | 315/1000 [00:04<00:09, 69.09it/s]Reranking:  32%|███▏      | 322/1000 [00:04<00:09, 69.15it/s]Reranking:  33%|███▎      | 330/1000 [00:04<00:09, 69.43it/s]Reranking:  34%|███▎      | 337/1000 [00:04<00:09, 69.38it/s]Reranking:  34%|███▍      | 345/1000 [00:05<00:09, 69.47it/s]Reranking:  35%|███▌      | 353/1000 [00:05<00:09, 69.63it/s]Reranking:  36%|███▌      | 360/1000 [00:05<00:09, 69.51it/s]Reranking:  37%|███▋      | 367/1000 [00:05<00:09, 69.12it/s]Reranking:  37%|███▋      | 374/1000 [00:05<00:09, 69.22it/s]Reranking:  38%|███▊      | 381/1000 [00:05<00:08, 69.10it/s]Reranking:  39%|███▉      | 388/1000 [00:05<00:08, 68.70it/s]Reranking:  40%|███▉      | 395/1000 [00:05<00:08, 68.84it/s]Reranking:  40%|████      | 402/1000 [00:05<00:08, 68.85it/s]Reranking:  41%|████      | 409/1000 [00:06<00:08, 68.78it/s]Reranking:  42%|████▏     | 416/1000 [00:06<00:08, 69.03it/s]Reranking:  42%|████▏     | 423/1000 [00:06<00:08, 68.99it/s]Reranking:  43%|████▎     | 431/1000 [00:06<00:08, 69.35it/s]Reranking:  44%|████▍     | 438/1000 [00:06<00:08, 69.39it/s]Reranking:  45%|████▍     | 446/1000 [00:06<00:07, 69.69it/s]Reranking:  45%|████▌     | 453/1000 [00:06<00:07, 69.49it/s]Reranking:  46%|████▌     | 460/1000 [00:06<00:07, 69.26it/s]Reranking:  47%|████▋     | 467/1000 [00:06<00:07, 68.84it/s]Reranking:  47%|████▋     | 474/1000 [00:06<00:07, 67.75it/s]Reranking:  48%|████▊     | 481/1000 [00:07<00:07, 68.22it/s]Reranking:  49%|████▉     | 488/1000 [00:07<00:07, 68.73it/s]Reranking:  50%|████▉     | 495/1000 [00:07<00:07, 68.16it/s]Reranking:  50%|█████     | 502/1000 [00:07<00:07, 68.55it/s]Reranking:  51%|█████     | 509/1000 [00:07<00:07, 68.84it/s]Reranking:  52%|█████▏    | 516/1000 [00:07<00:07, 68.95it/s]Reranking:  52%|█████▏    | 523/1000 [00:07<00:06, 69.10it/s]Reranking:  53%|█████▎    | 530/1000 [00:07<00:06, 69.34it/s]Reranking:  54%|█████▎    | 537/1000 [00:07<00:06, 69.22it/s]Reranking:  54%|█████▍    | 544/1000 [00:07<00:06, 69.04it/s]Reranking:  55%|█████▌    | 551/1000 [00:08<00:06, 68.71it/s]Reranking:  56%|█████▌    | 558/1000 [00:08<00:06, 68.53it/s]Reranking:  56%|█████▋    | 565/1000 [00:08<00:06, 68.69it/s]Reranking:  57%|█████▋    | 572/1000 [00:08<00:06, 68.58it/s]Reranking:  58%|█████▊    | 579/1000 [00:08<00:06, 68.60it/s]Reranking:  59%|█████▊    | 586/1000 [00:08<00:06, 68.39it/s]Reranking:  59%|█████▉    | 593/1000 [00:08<00:05, 68.61it/s]Reranking:  60%|██████    | 600/1000 [00:08<00:05, 68.86it/s]Reranking:  61%|██████    | 607/1000 [00:08<00:05, 68.57it/s]Reranking:  61%|██████▏   | 614/1000 [00:09<00:05, 67.57it/s]Reranking:  62%|██████▏   | 621/1000 [00:09<00:05, 67.13it/s]Reranking:  63%|██████▎   | 628/1000 [00:09<00:05, 67.65it/s]Reranking:  64%|██████▎   | 635/1000 [00:09<00:05, 68.29it/s]Reranking:  64%|██████▍   | 642/1000 [00:09<00:05, 68.69it/s]Reranking:  65%|██████▍   | 649/1000 [00:09<00:05, 68.79it/s]Reranking:  66%|██████▌   | 656/1000 [00:09<00:05, 68.67it/s]Reranking:  66%|██████▋   | 663/1000 [00:09<00:04, 68.57it/s]Reranking:  67%|██████▋   | 670/1000 [00:09<00:04, 68.59it/s]Reranking:  68%|██████▊   | 677/1000 [00:09<00:04, 68.13it/s]Reranking:  68%|██████▊   | 684/1000 [00:10<00:04, 68.02it/s]Reranking:  69%|██████▉   | 691/1000 [00:10<00:04, 68.48it/s]Reranking:  70%|██████▉   | 698/1000 [00:10<00:04, 68.34it/s]Reranking:  70%|███████   | 705/1000 [00:10<00:04, 68.38it/s]Reranking:  71%|███████   | 712/1000 [00:10<00:04, 68.25it/s]Reranking:  72%|███████▏  | 720/1000 [00:10<00:04, 68.80it/s]Reranking:  73%|███████▎  | 727/1000 [00:10<00:03, 68.25it/s]Reranking:  73%|███████▎  | 734/1000 [00:10<00:03, 67.70it/s]Reranking:  74%|███████▍  | 741/1000 [00:10<00:03, 68.33it/s]Reranking:  75%|███████▍  | 748/1000 [00:10<00:03, 67.58it/s]Reranking:  76%|███████▌  | 755/1000 [00:11<00:03, 68.08it/s]Reranking:  76%|███████▋  | 763/1000 [00:11<00:03, 68.81it/s]Reranking:  77%|███████▋  | 770/1000 [00:11<00:03, 68.93it/s]Reranking:  78%|███████▊  | 777/1000 [00:11<00:03, 69.03it/s]Reranking:  78%|███████▊  | 784/1000 [00:11<00:03, 69.16it/s]Reranking:  79%|███████▉  | 791/1000 [00:11<00:03, 69.39it/s]Reranking:  80%|███████▉  | 798/1000 [00:11<00:02, 69.40it/s]Reranking:  80%|████████  | 805/1000 [00:11<00:02, 69.55it/s]Reranking:  81%|████████  | 812/1000 [00:11<00:02, 69.50it/s]Reranking:  82%|████████▏ | 819/1000 [00:12<00:02, 69.02it/s]Reranking:  83%|████████▎ | 826/1000 [00:12<00:02, 68.88it/s]Reranking:  83%|████████▎ | 833/1000 [00:12<00:02, 68.93it/s]Reranking:  84%|████████▍ | 840/1000 [00:12<00:02, 68.66it/s]Reranking:  85%|████████▍ | 847/1000 [00:12<00:02, 68.66it/s]Reranking:  85%|████████▌ | 854/1000 [00:12<00:02, 66.12it/s]Reranking:  86%|████████▌ | 861/1000 [00:12<00:02, 66.82it/s]Reranking:  87%|████████▋ | 868/1000 [00:12<00:01, 67.65it/s]Reranking:  88%|████████▊ | 875/1000 [00:12<00:01, 67.62it/s]Reranking:  88%|████████▊ | 882/1000 [00:12<00:01, 67.35it/s]Reranking:  89%|████████▉ | 889/1000 [00:13<00:01, 66.82it/s]Reranking:  90%|████████▉ | 897/1000 [00:13<00:01, 67.90it/s]Reranking:  90%|█████████ | 905/1000 [00:13<00:01, 68.69it/s]Reranking:  91%|█████████ | 912/1000 [00:13<00:01, 68.13it/s]Reranking:  92%|█████████▏| 919/1000 [00:13<00:01, 68.51it/s]Reranking:  93%|█████████▎| 926/1000 [00:13<00:01, 68.62it/s]Reranking:  93%|█████████▎| 933/1000 [00:13<00:00, 68.47it/s]Reranking:  94%|█████████▍| 940/1000 [00:13<00:00, 68.77it/s]Reranking:  95%|█████████▍| 947/1000 [00:13<00:00, 68.56it/s]Reranking:  95%|█████████▌| 954/1000 [00:13<00:00, 66.58it/s]Reranking:  96%|█████████▌| 961/1000 [00:14<00:00, 65.63it/s]Reranking:  97%|█████████▋| 968/1000 [00:14<00:00, 65.21it/s]Reranking:  98%|█████████▊| 975/1000 [00:14<00:00, 65.28it/s]Reranking:  98%|█████████▊| 982/1000 [00:14<00:00, 64.91it/s]Reranking:  99%|█████████▉| 989/1000 [00:14<00:00, 64.93it/s]Reranking: 100%|█████████▉| 996/1000 [00:14<00:00, 64.67it/s]Reranking: 100%|██████████| 1000/1000 [00:14<00:00, 67.96it/s]
Results for MRAG + Time-Aware: {'hit@1': 0.787, 'hit@5': 0.942, 'hit@10': 0.965, 'hit@20': 0.979, 'mrr@1': 0.787, 'mrr@5': 0.8511166666666671, 'mrr@10': 0.8541099206349211, 'mrr@20': 0.8550582878507805}

==========================================================================================
                                      FINAL RESULTS                                       
==========================================================================================
Configuration          | Hit@1   | Hit@5   | Hit@10  | Hit@20  | MRR@1   | MRR@5   | MRR@10  | MRR@20 
------------------------------------------------------------------------------------------
Base Only              | 0.7170  | 0.9210  | 0.9540  | 0.9720  | 0.7170  | 0.7993  | 0.8038  | 0.8051 
Base + MRAG            | 0.7830  | 0.9430  | 0.9590  | 0.9750  | 0.7830  | 0.8475  | 0.8498  | 0.8510 
Time-Aware Only        | 0.7290  | 0.9270  | 0.9580  | 0.9830  | 0.7290  | 0.8070  | 0.8111  | 0.8129 
Time-Aware + MRAG      | 0.7870  | 0.9420  | 0.9650  | 0.9790  | 0.7870  | 0.8511  | 0.8541  | 0.8551 
==========================================================================================
